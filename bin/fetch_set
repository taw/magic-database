#!/usr/bin/env ruby

require "set"
require_relative "../lib/magic_database"

ARGV.each do |set_name|
  cards_to_fetch = Set[]
  checklist_page = GathererSetChecklistPage.new(set_name, 0)
  while checklist_page
    checklist_page.cards.each do |card_row|
      cards_to_fetch << card_row[0]
    end
    checklist_page = checklist_page.next_page
  end

  cards_to_fetch.each do |id|
    GathererDetailsPage.new(id).card_info
    GathererLanguagesPage.new(id).doc
  end
end
